<!doctype html>
<html  manifest="../../app.manifest">
<head>
<meta content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
<meta content="application/xhtml+xml;charset=UTF-8" http-equiv="Content-Type">
<meta content="no-cache,must-revalidate" http-equiv="Cache-Control">
<meta content="no-cache" http-equiv="pragma">
<meta content="0" http-equiv="expires">
<meta content="telephone=no, address=no" name="format-detection">
<meta name="apple-mobile-web-app-capable" content="yes" /> <!-- apple devices fullscreen -->
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<title>修改密码</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<link rel="stylesheet" type="text/css" href="../../plug-ins/swiper/swiper-3.4.0.min.css" media="all" />
<link rel="stylesheet" type="text/css" href="../../css/common.css" media="all" />
<link rel="stylesheet" type="text/css" href="../../css/style.css" media="all" />

</head>

<body class="set-news-pass-body">
 <header class="head">
   <a href="javascript:history.go(-1);" class="arrow-left"><img src="../../images/setup/arrow-left.png"></a> <span>修改密码</span>
 </header>
 <section class="main  set-news-pass">
   <div class="input-group"><input type="password" name="old-pass" id="old-pass" placeholder="请输入原密码"></div>
   <div class="input-group"><input type="password" name="new-pass" id="new-pass" placeholder="请输入新密码"></div>
   <div class="input-group"><input type="password" name="confirm-pass" id="confirm-pass" placeholder="请输入确认新密码"></div>
   
   <div class="btn-box"><a class="btn" id="subBtn">保&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;存</a></div>
 </section>
</body>
<script type="text/javascript" src="../../js/config.js"></script>
<script type="text/javascript" src="../../js/common.js"></script>
<script type="text/javascript" src="../../js/app.js"></script>
<script type="text/javascript" src="../../js/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="../../js/jquery.lazyload.js"></script>
<script src="../../../data/resource/js/layer/layer.js"></script>
<script type="text/javascript" src="../../plug-ins/swiper/swiper-3.4.0.jquery.min.js"></script>
<script type="text/javascript" src="../../js/main.js"></script>
<script type="text/javascript" src="../../js/tmpl/footer.js"></script>
<script type="text/javascript">
    $(function(){
        $('body').on('click','#subBtn',function(){
            var key = getcookie('key');
            var old_pass = $('#old-pass').val();
            var new_pass = $('#new-pass').val();
            var confirm_pass = $('#confirm-pass').val();

            if(old_pass == ''){
                layer.alert('原密码不能为空!');
                $('.layui-layer').css('left',document.body.clientWidth/5);
                return false;
            }
            if(new_pass == ''){
                layer.alert('新密码不能为空!');
                $('.layui-layer').css('left',document.body.clientWidth/5);
                return false;
            }
            if(new_pass != confirm_pass){
                layer.alert('新密码与确认密码不一致!');
                $('.layui-layer').css('left',document.body.clientWidth/5);
                return false;
            }
            if(new_pass.length < 6){
                layer.alert('新密码长度不能少于6位!');
                $('.layui-layer').css('left',document.body.clientWidth/5);
                return false;
            }

            if (key == '') {
                window.location.href = WapSiteUrl + '/tmpl/member/login.html';
                return false;
            }

            $.ajax({
                url: SiteUrl + "/m/index.php?act=member_info&op=edit_password",
                type: 'post',
                data: {key:key,password_type: 'mp',old_password:old_pass,new_password:new_pass,confirm_password:confirm_pass},
                dataType: 'json',
                success: function (result) {
                    var data = result.datas;

                    if(data.status == 1){
                        layer.confirm(data.msg, {
                            title: '提示信息',
                            btn: ['确定'] //按钮
                        }, function () {
                            delCache('key');
                            window.location.href = WapSiteUrl + '/tmpl/member/login.html';
                        }, function () {

                        });

                    }else{
                        layer.alert(data.msg);
                    }

                    $('.layui-layer').css('left',document.body.clientWidth/5);

                }
            });
        });
    });
</script>
</html>
